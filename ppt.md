# 프로젝트 수행 경과 PPT 구성안

## 1. PPT 구성안(슬라이드 흐름)
### 1) 프로젝트 한줄 소개
- 중고 경매 거래 MSA 백엔드

### 2) 목표/범위
- MSA/DDD 기반 분리, Kafka 이벤트 흐름, 실시간 경매, AI 추천·생성까지 엔드투엔드 구현

### 3) 아키텍처(인프라/배포/CI/CD)
- 2-Node K3s 기반 운영(인프라/서비스 노드 분리)
- Rolling Update, 헬스 프로브로 무중단 배포 지향
- Secret 기반 환경변수 주입, 서비스별 독립 배포
- GitHub Actions -> Docker -> K8s 자동 배포 파이프라인
- 그림 설명: Control Plane=공용 인프라, Worker=비즈니스 서비스

### 4) 기술스택
- 프레임워크: Spring Boot, React
- 아키텍처 스타일: MSA, DDD
- 통신 방식: REST, Kafka, WebSocket(STOMP), SSE
- 데이터/스토리지: PostgreSQL, Redis, Elasticsearch, pgvector, AWS S3
- AI/추천: Spring AI, OpenAI(Chat/Image)
- 보안/인증: Spring Security, JWT, OAuth(Google/Naver)
- 배치/스케줄링: Spring Batch

### 5) 도메인 종류 및 서비스 구성

| 도메인 | 역할/기능 |
| --- | --- |
| auction | 경매 생성/운영, 입찰, 실시간 상태, 랭킹/추천 |
| file | 파일/이미지 업로드 및 관리 |
| order | 주문/정산 흐름 관리 |
| deposit | 예치금/결제/환불, 외부 결제 연동 |
| product | 상품/카테고리/이미지, 상품 추천/자동 생성 |
| user | 인증/회원/판매자/알림 |

- Gateway–Discovery–Config–서비스 모듈 구조
- MSA + DDD 기반으로 도메인을 분리해 확장성과 팀 단위 개발을 동시에 확보
- 동기 REST와 비동기 Kafka 이벤트 병행으로 실시간성과 안정성 확보

### 6) 디렉토리 구조
```text
backend
|-- apigateway
|-- auction
|-- common
|-- config
|-- discovery
|-- deposit
|-- product
|-- search
|-- settlement
`-- user
```
- 공통 코드(DTO/예외/이벤트/유틸)는 common 모듈로 분리
- config/discovery/apigateway는 인프라 공통 계층

### 7) 주요 기능 구현 결과 개요
- 일반 사용자 플로우(회원가입/로그인, JWT/OAuth -> 조회/검색 -> 추천 -> 입찰 -> 예치금 충전/결제/낙찰 -> 알림 -> 판매자 등록 신청 )
- 판매자 플로우( 상품/시작가 등록 -> 상품정보, 상품사진 AI 자동생성 -> 정산)
- 어드민 플로우(판매자/회원 관리 -> 상품/경매 관리 -> 주문/정산/결제 관리 -> 검색 인덱스 관리 -> 대시보드/운영 알림)

### 9) 핵심 기능 선정
- RAG 기반 AI 기능(상품 추천/자동 생성)
- 이벤트 기반 상태 동기화
- 실시간 입찰 처리
- 결제 시스템
- API Gateway 인증/인가

### 10) 핵심 기능 구현 내용
- RAG 기반 AI 기능
  - 상품 추천
    - 쉬운 설명: 관심 상품과 비슷한 상품을 찾아 한 줄 추천까지 보여준다.
    - 전문 설명: pgvector 기반 VectorStore 유사도 검색 + 의도 분류 후 RAG로 추천 문장 구성.
  - 상품등록정보 자동생성
    - 쉬운 설명: 입력만 주면 상품 설명과 이미지가 자동으로 만들어진다.
    - 전문 설명: ChatClient + PromptTemplate + Tool로 스펙 생성, ImageModel로 이미지 생성 후 등록 자동화.
  - 경매 시작가 추천
    - 쉬운 설명: 판매자가 시작가를 정할 때 참고 값을 제공한다.
    - 전문 설명: 유사 상품/낙찰 데이터를 기반으로 시작가와 가격 범위를 추천.
- 이벤트 기반 상태 동기화
  - 쉬운 설명: 서비스 사이 상태 변경을 이벤트로 알리고, 중복 처리 없이 동기화한다.
  - 전문 설명: KafkaEventEnvelope로 eventId/타임스탬프 포함 발행, Listener AOP에서 멱등 처리 및 지연 로깅.
  - 쉬운 설명: 상품/경매가 바뀌면 검색 인덱스가 자동 갱신된다.
  - 전문 설명: 상품/경매 변경 이벤트를 수신해 검색 인덱스를 업데이트.
- 실시간 입찰 처리
  - 쉬운 설명: 입찰하면 바로 화면에 반영된다.
  - 전문 설명: STOMP WebSocket + SockJS fallback 구성으로 실시간 메시지 전송.
  - 쉬운 설명: 같은 사람이 여러 번 집계되지 않게 처리한다.
  - 전문 설명: 핸드셰이크에서 IP/UA 수집 후 중복 조회키로 집계.
  - 쉬운 설명: 동시에 입찰해도 충돌을 줄이고 기록을 남긴다.
  - 전문 설명: Optimistic Lock 재시도, 입찰 검증/이력 기록, 실시간 브로드캐스트.
- 결제 시스템
  - 쉬운 설명: 주문을 만들고 결제 상태에 따라 자동으로 상태가 바뀐다.
  - 전문 설명: 주문 생성/상태 전이 + 예치금 사용 API 연동.
  - 쉬운 설명: 결제 성공/실패를 기록하고 후속 처리를 이어간다.
  - 전문 설명: Toss 결제 승인/검증, 실패 이력 저장, 결제 확정 이벤트 발행.
  - 쉬운 설명: 결제 결과가 주문에 바로 반영된다.
  - 전문 설명: 결제 완료/실패 Kafka 이벤트 수신 후 주문 상태 갱신.
- API Gateway 인증/인가
  - 쉬운 설명: 로그인한 사용자만 접근하게 하고 역할에 따라 막는다.
  - 전문 설명: JWT 파싱/검증 후 사용자 ID 헤더 주입.
  - 쉬운 설명: 권한 규칙이 바뀌면 바로 반영된다.
  - 전문 설명: endpoint role 기반 인가 체크 + 정책 버전 캐시/갱신으로 런타임 반영.

### 11) 피드백 및 개선
- Kafka 중복 소비 -> 이벤트 멱등 처리 추가
- 권한 정책 변경 재배포 부담 -> Gateway 룰 버전 캐시/동기화
- AI 비용/지연 -> ai-enabled/캐시/요약 fallback 적용
- 동시 입찰 충돌 -> Optimistic Lock 예외 처리

### 12) 결과/시연
- Swagger 집계 화면, 실시간 경매 화면, 검색 추천 결과, 배포 상태
- 첨부 자료: 아키텍처 다이어그램, 이벤트 시퀀스, Swagger 캡처, 실시간 입찰 영상, 검색/추천 결과, K8s 상태, CI/CD 로그

### 13) 활용방안 및 기대효과
- 사회적 효용: 지속 가능한 소비 문화 확산, 공정한 거래 환경, 디지털 접근성 향상
- 기술적 효용: MSA 확장성, 이벤트 기반 처리 역량, 운영 자동화, AI 확장 가능 구조
- 비즈니스 활용성: 거래 수수료, 프리미엄 기능, 광고/데이터 수익, 서비스 구조 재사용
